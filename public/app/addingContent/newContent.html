<h1 class="page-header">Add Library Content</h1>

<div ng-controller="addingContentCtrl" class="container" >

    <form name="addContentForm">
        <accordion>
            <accordion-group heading="Identify Your Content">
                <h4>Paste a URL below or choose a file to upload:</h4>
                <div ng-controller="fileSelectionCtrl" class="f-flexC f-row f-wrap f-m-around">
                    
                    <div class="f-flexC f-row f-wrap f-m-around f-c-center">
                        <div  ng-disabled="displaySettings.disableFileSelection" class="fileUpload btn btn-primary">
    
                            <span>Select File</span>
                            <input ng-disabled="displaySettings.disableFileSelection" type="file" class="upload" ng-file-select="onFileSelect($files)"/>
    
                        </div>
    
                        <input  class="form-control" id='disabledInput' ng-if="displaySettings.fileSelected" ng-model="displaySettings.fileName" disabled type="text"/>
    
                        <input  class="form-control" ng-if="!displaySettings.fileSelected" name="pasteURL" ng-model="contentObject.webURL" type="URL" ng-change="onURLChange()">
    
                        <button ng-show="displaySettings.optionSelected" class="btn fileUpload" ng-click="reset()">Reset</button>
                    </div>
                    
                    <small class="text-danger" ng-show="displaySettings.uploadNonImage">You may only upload images at this time.</small>
                    
                    <!-- TODO: support for dropping files, canceling uploads. Good place to show upload progress? -->
                    <!--  <div ng-file-drop="onFileSelect($files)" ng-file-drag-over-class="optional-css-class"
                          ng-show="dropSupported">drop files here</div>
                    <div ng-file-drop-available="dropSupported=true" 
                          ng-show="!dropSupported">HTML5 Drop File is not supported!</div>
                    <button ng-click="upload.abort()">Cancel Upload</button> -->
                    
                    <div ng-if="displaySettings.fileSelected">
                        <label>Preview:</label>
                        <br>
                        <img height="300px" ng-src="{{displaySettings.dataUrl.image}}">
                    </div>
                    
                    <div ng-if="displaySettings.imageURLPresent">
                        <label>Preview:</label>
                        <br>
                        <img height="300px" ng-src="{{contentObject.webURL}}">
                    </div>

                </div>
          
            </accordion-group>
    
            <accordion-group heading="Identify Relevant Terms">
            <!-- TODO: add in other selection options (dropdown menu, popup menu...) -->
            <!-- TODO: add touch support for draggin buttons -->
            <!-- TODO: set up drop channels that don't accept an element coming from its own container -->
                <div ng-controller="termSelectionCtrl">
                    <div class="row margin5 f-flexC f-m-center margin20">
                        <div>
                            <suggest ng-show="displayOptions.addingNewTerm" class='form-control' on-select="openNewTermModal(data)" lang="{{displayLanguage}}"></suggest>
                            <input ng-show="!displayOptions.addingNewTerm" type="text" class="form-control" ng-model="DBTerm" ng-change="findTerm()" typeahead-on-select="addToSelectedFromDB()" typeahead="term as term.name for term in typeAhead" placeholder="Type term name here" >
                            <button ng-click="displayOptions.addingNewTerm = !displayOptions.addingNewTerm" class='btn btn-default btn-sm'>Change Source</button>
                            <i class='text-muted fa fa-question-circle'></i>
                        </div>
                    </div>

                    <div >

                        <div class="col-sm-6"> 
                            <div> 
                            <!-- TODO: help text popovers/tooltips -->
                            <!-- TODO: write in a button to clear all search terms -->
                            <!-- TODO: return related terms (to be done after some content has been added) -->
                                <div ui-on-Drop="recievingHandler($data, contentTerms.search)" drag-enter-class="droppable" class='well well-sm'>
                                    <i class='pull-right text-muted fa fa-question-circle'></i>
                                    <span ng-hide="contentTerms.search.length > 0" class="dn-fade text-muted background h3">search terms</span>
                                    <div class="f-flexC f-row f-m-around f-wrap">
                                     <button ui-draggable="true" on-drop-success="dropFromHandler($index,contentTerms.search)" drag="term" ng-repeat="term in contentTerms.search" class='dn-bounce above btn margin5 btn-default'>{{term.name}}</button>
                                    </div>
                                </div>
                            </div>
                            <div> 
                            <!-- TODO: fix initial placement mismatch of filter popover -->
                            <!-- TODO: fix display for mobile devices -->
                                <button class='btn btn-default btn-xs' popover-template="app/shared/filterPartial.html" ng-click="popoverOpen = !popoverOpen" popover-placement="right">
                                    <i class="fa fa-filter"></i> 
                                    <span ng-show='!popoverOpen'>open filter options</span>
                                    <span class='text-danger' ng-show='popoverOpen'>close filter options</span>
                                </button>
                                <div ui-on-Drop="recievingHandler($data, contentTerms.related)" drop-channel="noneShallPass" drag-enter-class="droppable" class='well well-sm height200'>
                                    <i class='pull-right text-muted fa fa-question-circle'></i>
                                    <span ng-hide="contentTerms.related.length > 0" class="dn-fade text-muted background h3">related terms</span>
                                    <div class="f-flexC f-row f-m-around f-wrap">
                                        <button ui-draggable="true" on-drop-success="dropFromHandler($index,contentTerms.related)" drag="term" ng-repeat="term in contentTerms.related" class='dn-bounce above btn margin5 btn-default'>{{term.name}}</button>
                                    </div>
                                </div>
                            </div>                        
                        </div> 

                       <div class="col-sm-6">     
                            <div ui-on-Drop="recievingHandler($data, contentTerms.selected)" drag-enter-class="droppable" class="well well-sm height200">
                                <i class='pull-right text-muted fa fa-question-circle'></i>
                                <div class="f-fleC f-row f-m-center">
                                    <span ng-hide="contentTerms.selected.length > 0"class="dn-fade text-muted background h3">selected terms</span>
                                    <div class="f-flexC f-row f-m-around f-wrap">
                                        <button ui-draggable="true" on-drop-success="dropFromHandler($index,contentTerms.selected)" drag="term" ng-repeat="term in contentTerms.selected" class='dn-bounce above btn margin5 btn-default'>{{term.name}}</button>
                                    </div>
                                </div>
                            </div>
        
                            <div ui-on-Drop="recievingHandler($data, contentTerms.discarded)" drag-enter-class="droppable" class="well well-sm">
                                <i class='pull-right text-muted fa fa-question-circle'></i>
                                <div class="f-fleC f-row f-m-center">
                                    <span ng-hide="contentTerms.discarded.length > 0" class="dn-fade text-muted background h3">discarded terms</span>
                                    <div class="f-flexC f-row f-m-around f-wrap">
                                        <button ui-draggable="true" on-drop-success="dropFromHandler($index, contentTerms.discarded)" drag="term" ng-repeat="term in contentTerms.discarded" class='dn-bounce above btn margin5 btn-default btn-xs'>{{term.name}}</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </accordion-group>
    
            <!-- <accordion-group heading="Add Meta Information">
                <div>
                    source, publisher, dates, relevant links, description
                </div>
                <div>
                    <label>Add source:</label>
                    <br>
                    <input class="form-control" type="text" ng-model="">
                </div>

                <div>
                    <Button class="btn btn-default" ng-model="">Add relevant link</Button>
                    <label>URL</label>
                    <input type='text' class='form-control'>
                </div>

                <div>
                    <label>Description</label>
                    <text-angular class='ta-editor' ta-toolbar="[['h1','h2','h3'],['bold','italics']]" ng-model="example"></text-angular>
                </div>   
            </accordion-group> -->

        </accordion>
                
    </form>
    <br>
    <button ng-click="submitNewContent()"class="btn btn-primary btn-large">Add Content</button>
</div>